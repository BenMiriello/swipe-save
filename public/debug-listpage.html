<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Debug List Page</title>
  <style>
    body { margin: 20px; font-family: monospace; }
    .error { color: red; }
    .success { color: green; }
  </style>
</head>
<body>
  <h1>Debug List Page Initialization</h1>
  <div id="debug-output"></div>
  
  <script>
    function debugLog(msg, isError = false) {
      console.log(msg);
      const div = document.createElement('div');
      div.className = isError ? 'error' : (msg.includes('✓') ? 'success' : '');
      div.innerHTML = msg;
      document.getElementById('debug-output').appendChild(div);
    }
    
    debugLog('1. Starting debug...');
  </script>
  
  <!-- Load essential dependencies -->
  <script src="js/config.js"></script>
  
  <script>
    debugLog('2. Config loaded. window.appConfig available: ' + !!window.appConfig);
  </script>
  
  <!-- Load Alpine.js CDN first -->
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.14.1/dist/cdn.min.js" defer></script>
  
  <!-- Load stores -->
  <script src="js/stores/app-state-store.js"></script>
  <script src="js/stores/list-view-store.js"></script>
  
  <script>
    debugLog('3. Stores loaded');
    
    // Wait for Alpine to be ready
    document.addEventListener('alpine:init', () => {
      debugLog('4. Alpine initialized');
      debugLog('5. listView store available: ' + !!Alpine.store('listView'));
      
      // Try to access the store
      if (Alpine.store('listView')) {
        debugLog('6. ✓ Store accessible');
        try {
          const store = Alpine.store('listView');
          debugLog('7. Store methods: ' + Object.getOwnPropertyNames(store).join(', '));
        } catch (error) {
          debugLog('7. Error accessing store: ' + error.message, true);
        }
      }
    });
  </script>
  
  <!-- Load router and page controllers -->
  <script src="js/router.js"></script>
  <script src="js/pages/list-page.js"></script>
  
  <script>
    debugLog('8. Router and list page loaded');
    debugLog('9. window.router available: ' + !!window.router);
    debugLog('10. window.listPage available: ' + !!window.listPage);
    
    // Test initialization
    setTimeout(() => {
      debugLog('11. Testing list page init...');
      try {
        if (window.listPage && window.listPage.init) {
          window.listPage.init().then(() => {
            debugLog('12. ✓ List page init completed');
          }).catch(error => {
            debugLog('12. List page init failed: ' + error.message, true);
          });
        } else {
          debugLog('12. listPage.init method not available', true);
        }
      } catch (error) {
        debugLog('12. Error calling init: ' + error.message, true);
      }
    }, 2000);
  </script>
</body>
</html>