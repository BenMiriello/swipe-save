<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Debug Routing</title>
</head>
<body>
  <h1>Debug Routing System</h1>
  <div id="debug-output"></div>
  
  <script>
    function debugLog(msg) {
      console.log(msg);
      document.getElementById('debug-output').innerHTML += '<p>' + msg + '</p>';
    }
    
    debugLog('1. Loading router...');
  </script>
  
  <!-- Load router -->
  <script src="js/router.js"></script>
  
  <script>
    debugLog('2. Router loaded, window.router available: ' + !!window.router);
    if (window.router) {
      debugLog('3. Router routes: ' + Array.from(window.router.routes.keys()).join(', '));
    }
    
    debugLog('4. Loading page controllers...');
  </script>
  
  <!-- Load page controllers -->
  <script src="js/pages/list-page.js"></script>
  <script src="js/pages/view-page.js"></script>
  
  <script>
    debugLog('5. Page controllers loaded');
    debugLog('6. window.listPage available: ' + !!window.listPage);
    debugLog('7. window.viewPage available: ' + !!window.viewPage);
    
    debugLog('8. Loading route-app...');
  </script>
  
  <!-- Load route-app -->
  <script src="js/route-app.js"></script>
  
  <script>
    debugLog('9. Route-app loaded');
    
    setTimeout(() => {
      if (window.router) {
        debugLog('10. Final router routes: ' + Array.from(window.router.routes.keys()).join(', '));
        debugLog('11. Current location: ' + window.location.pathname);
        
        // Manually register routes if they weren't registered
        if (window.router.routes.size === 0) {
          debugLog('12. No routes found, registering manually...');
          
          try {
            window.router.register('/list', async (params) => {
              debugLog('13. /list route executed!');
              if (window.listPage && window.listPage.init) {
                await window.listPage.init();
                debugLog('14. List page initialized');
              }
            });
            
            debugLog('15. Manual route registered');
            debugLog('16. Routes after manual: ' + Array.from(window.router.routes.keys()).join(', '));
            
            // Test the route
            if (window.location.pathname === '/debug-routing.html') {
              debugLog('17. Testing manual route navigation...');
              window.router.navigate('/list');
            }
          } catch (error) {
            debugLog('18. Error in manual route registration: ' + error.message);
          }
        }
      }
    }, 1000);
  </script>
</body>
</html>